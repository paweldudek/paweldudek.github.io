
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>All Posts - Paweł Dudek</title>
  <meta name="author" content="Paweł Dudek">

  
  <meta name="description" content="All Posts Tightening Your Cycles BDD is about constant feedback. Constant feedback about the code you write. Constant feedback whether your last &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://paweldudek.github.io/posts">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/font-awesome.min.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Paweł Dudek" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-56652602-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

  <body>
    <a href="/" class="home-icon">
      <img src="/images/home.png"/>
    </a>

    <div class="all-posts">
  <div class="container">
    <div class="row">
      <div class="list-title col-md-offset-3 col-md-6">
        <h4>All Posts</h4>
      </div>
    </div>
  </div>

  <div class="article-list">
    <div class="container">
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2015/05/20/cycles/">Tightening Your Cycles</a></h2>
  
  <p>
    <p>BDD is about constant feedback.</p>




<p>Constant feedback about the code you write. Constant feedback whether your last refactor broke something, or whether everything works as expected. Your tests are here to tell you whether everything is OK.</p>




<p>The sooner you get that feedback the better. By receiving information about state of your system as soon as possible you keep your flow uninterrupted. You stay focused on the task that you&rsquo;re currently trying to complete. And you&rsquo;re able to determine whether changes you&rsquo;re introducing are the right direction.</p>




<p>Moreover you don&rsquo;t have to constantly <em>launch</em> the app to check whether the change you&rsquo;ve just made works. By receiving feedback as soon as possible you <em>shorten</em> your evaluation cycles. You shorten the time between writing your code and being sure that it works as you&rsquo;d expect.</p>




<p>In short, you&rsquo;re just working faster.</p>




<p>Unfortunately with Xcode (or Appcode) doesn&rsquo;t really provide this constant feedback - you have to remember to run Test action each time you need to see results. This solution is not perfect - your tests should be executed each time you make a change to your system.</p>




<p>Fortunately we programmers like to build tools. Specifically in this case we can leverage <code>FileWatcher</code>, a Ruby gem that fires a notification each time a file changes in specified directory. We can use that gem to execute <code>xcodebuild test</code> automatically each time test or implementation files change.</p>




<p>The only problem with trick above is that output from <code>xcodebuild test</code> is quite a mess, especially when your test suite grows large. Imagine what happens when your app reaches two thousand, or more, tests - finding which one failed would become quite a challenge.</p>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(…)
</span><span class='line'>
</span><span class='line'>-[SpecSuiteName passing_spec_name]
</span><span class='line'>  Test Case '-[SpecSuiteName passing_spec_name]' started.
</span><span class='line'>  Test Case '-[SpecSuiteName passing_spec_name]' passed (0.271 seconds).
</span><span class='line'>
</span><span class='line'>-[SpecSuiteName failling_spec_name]
</span><span class='line'>  Test Case '-[SpecSuiteName failling_spec_name]' started.
</span><span class='line'>  Test Case '-[SpecSuiteName failling_spec_name]' failed (0.002 seconds).
</span><span class='line'>
</span><span class='line'>(…)
</span><span class='line'>
</span><span class='line'>Executed 2 tests, with 1 failure (1 unexpected) in 0.273 (0.278) seconds
</span><span class='line'>
</span><span class='line'>2 tests; 0 skipped; 1 failure; 1 exception; 0 pending</span></code></pre></td></tr></table></div></figure>




<p>This is where <a href="https://github.com/supermarin/xcpretty">xcpretty</a> comes in. It&rsquo;s a really simple tool - the only thing it actually does is that it parses output Xcode throws out when performing <code>xcodebuild test</code>. You get a green <code>.</code> for a passed test and a red <code>F</code> for a failed one. Plus all the info you can get for a failed test. But it gets even better - since <code>xcpretty</code> doesn&rsquo;t print all information <code>xcodebuild</code> gives it is actually <em>faster</em> than running tests normally.</p>




<p>So here it is, the aforementioned script. Is uses Ruby and <code>filewatcher</code> gem, thus you should call <code>gem install filewatcher</code> prior to running it:</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;filewatcher&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;system-bang&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">workspace_name</span> <span class="o">=</span> <span class="no">Dir</span><span class="o">[</span><span class="s2">&quot;*.xcworkspace&quot;</span><span class="o">].</span><span class="n">last</span>
</span><span class='line'><span class="c1"># We assume that the name of the file is also the name of main scheme we&#39;ll be testing</span>
</span><span class='line'><span class="n">scheme_name</span> <span class="o">=</span> <span class="n">workspace_name</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
</span><span class='line'>
</span><span class='line'><span class="n">exit_with_message</span><span class="p">(</span><span class="s2">&quot;Expected to find a workspace in current working directory, but none found.&quot;</span><span class="p">)</span> <span class="k">unless</span> <span class="n">workspace_name</span>
</span><span class='line'>
</span><span class='line'><span class="no">FileWatcher</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="o">[</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">scheme_name</span><span class="si">}</span><span class="s2">/&quot;</span><span class="o">]</span><span class="p">)</span><span class="o">.</span><span class="n">watch</span> <span class="k">do</span> <span class="o">|</span><span class="n">filename</span><span class="o">|</span>
</span><span class='line'>  <span class="n">system_command</span> <span class="o">=</span> <span class="s2">&quot;xcodebuild test -workspace &#39;</span><span class="si">#{</span><span class="n">workspace_name</span><span class="si">}</span><span class="s2">&#39; -scheme &#39;</span><span class="si">#{</span><span class="n">scheme_name</span><span class="si">}</span><span class="s2">&#39; -sdk iphonesimulator -destination </span><span class="se">\&quot;</span><span class="s2">platform=iOS Simulator,name=iPad Retina,OS=7.1</span><span class="se">\&quot;</span><span class="s2"> | xcpretty -c --no-utf --test&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nb">puts</span> <span class="s2">&quot;Executing: </span><span class="si">#{</span><span class="n">system_command</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="c1"># Kill xcodebuild to make sure we kill previous results</span>
</span><span class='line'>  <span class="nb">system</span><span class="o">!</span><span class="p">(</span><span class="s1">&#39;killall xcodebuild -t `tty` 2&gt;/dev/null || true&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="nb">system</span><span class="o">!</span> <span class="n">system_command</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Helpers</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">exit_with_message</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="n">red</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span class='line'>  <span class="nb">exit</span> <span class="mi">1</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">colorize</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">color_code</span><span class="p">)</span>
</span><span class='line'>  <span class="s2">&quot;</span><span class="si">#{</span><span class="n">color_code</span><span class="si">}#{</span><span class="n">text</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m&quot;</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">red</span><span class="p">(</span><span class="n">text</span><span class="p">);</span>
</span><span class='line'>  <span class="n">colorize</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\e</span><span class="s2">[31m&quot;</span><span class="p">);</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>You can use this script not only for running your tests, but for checking whether your app compiles. This can be a great tool for checking whether your Swift code is valid without relying on Xcode.</p>




<p>If you have any comments, hit me on <a href="http://twitter.com/eldudi">Twitter</a>.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2015-05-20T14:00:00+02:00" pubdate data-updated="true"></time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/script/'>script</a>, <a class='category' href='/blog/categories/tdd/'>tdd</a>, <a class='category' href='/blog/categories/test/'>test</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
    </div>
  </div>
</div>

    <footer id="footer" class="her-row">
  <div class="container">
    <div class="row">
      
<div class="col-md-2 col-sm-2 col-xs-10">
  <div class="social-icon-list">
    
    <a href="https://twitter.com/eldudi"><i class="fa fa-twitter-square fa-lg"></i></a>
    

    
    <a href="https://github.com/paweldudek"><i class="fa fa-github-square fa-lg"></i></a>
    

    

    
    <a href="mailto:hello@dudek.mobi"><i class="fa fa-envelope-square fa-lg"></i></a>
    
  </div>
</div>

<div class="col-md-10 col-sm-10 col-xs-6">
	<div class="pull-right">
		<h4>Powered by <a href="http://octopress.org/">Octopress</a>. Designed by <a href="http://AdrianArtiles.com">Adrian Artiles</a>. Copyright 2014 © Paweł Dudek.</h4>
	</div>
</div>

    </div>
  </div>
</footer>

    
  </body>
</html>
